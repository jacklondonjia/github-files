<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!--  $Id: ilinkTARGET.html 123 2011-11-01 13:01:33Z peterod $-->
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemalocation="http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
<title>ARM用IAR ILINKリンカのリリースノート</title>
    <link type="text/css" rel="stylesheet" media="all" href="style/ewic.css" />
</head>
<body>
    <div id="topbanner">
    </div>
    <div id="titlebanner_small">
        <h2>
ARMバージョン 6.30.4用IAR ILINKリンカのリリースノート
        </h2>
    </div>
    <div class="breadcrumb">
<a href="index.JPN.html">ARM用IARインフォメーションセンタ </a> | <a href="release_notes.JPN.html">リリースノート</a> | <a href="components.JPN.html">コンポーネント</a> | ARM用 IAR ILINK リンカーのリリースノート
    </div>
    <div class="mainblock">
        <ul>
<li><a href="#important">重要な情報</a> </li>
<li><a href="#features">新機能</a> </li>
<li><a href="#problems">既知の問題</a> </li>
<li><a href="#pcorr">プログラム修正</a> </li>
<li><a href="#manuals">ユーザガイドの訂正</a> </li>
<li><a href="#misc">その他</a> </li>
<li><a href="#history">リリース履歴</a> </li>
        </ul>
        <!--======================================================================-->
        <!-- IMPORTANT INFORMATION                                                -->
        <!--======================================================================-->
        <h3>
<a name="important" id="important"></a>重要な情報
        </h3>
﻿<ul>
  <li>
<p>5.20ツールセットには、プログラム起動時にすべて（または大部分）のコードをRAMにコピー可能にする新しい機能が備わっています。これらの機能の１つでは、起動コードが参照するセクションが'initialize by copy'ディレクティブの影響を受けないようにリンカが保護し、コピー初期化が完了した後に実行されるコードのみがRAMにコピーされるようにします。<br>場合によっては、新しいリンカおよびライブラリとリンクしたときに、以前のプロジェクトが機能しなくなる可能性もあります。一例として、リリース5.1Xのいずれかのモジュールに基づいて独自のcstartupモジュールを提供し、'initialize by copy'ディレクティブで、プログラム起動時に割込みテーブルがRAMにコピーされるよう指定する場合が考えられます。<br>これを修正するには、割込みテーブルに特殊なシンボル<code>__iar_init$$done</code>でマークを付け、必要となる前にコピー初期化を実行するよう指示します。こうしなければ、'initialize by copy'ディレクティブで記述されていても、割込みテーブルはコピーされません。Cortex-Mコプロセッサの場合、これを行う必要があるのは、独自のcmainモジュールも提供する場合のみです。
       <p>
Atmelの例はほとんどの場合、上記の方法で記述されています。修正する方法は、ラベル<code>__iar_init$$done</code>をベクタテーブルの前に置くことです。<br>例：
<pre><code>
SECTION .intvec:CODE:NOROOT(2)
ARM
__iar_init$$done:; ベクタテーブルはコピー初期化が
; 実行されるまで不要
__vector:
LDR     PC,Reset_Addr   ; リセット
        :
        :
</code></pre>
       </p>
  </li>


      <li>
<b>EWARM 6.10.2:</b><br>
        <p>
コードサイズ制限版では、リンカはベーシックなヒープ実装を選択します。つまり、リンカコマンドラインオプションの<code>--basic_heap</code>が標準版で使用される場合と同じです。
        </p>
      </li>
</ul>
        <!--======================================================================-->
        <!-- NEW FEATURES                                                         -->
        <!--======================================================================-->
        <h3>
<a name="features" id="features"></a>新機能
        </h3>
﻿<ul>
  <li>
なし。
  </li>
</ul>
        <!--======================================================================-->
        <!-- Known Problems-->
        <!--======================================================================-->
        <h3>
<a name="problems" id="problems"></a>既知の問題
        </h3>
﻿<ul>
  <li>
    <p>
<code>cstartup.s</code>を使用してビルドすると、MISRA-Cチェッカでエラーが誤って報告されます。<br>[EW19800]
    </p>
  </li>

  <li>
    <p>
リンカ設定ファイルの<code>==</code>および<code>!=</code>演算子で、間違った結果が生成されます。<br>[EW22755]
    </p>
  </li>

</ul>
        <!--======================================================================-->
        <!-- Program Corrections                                                  -->
        <!--======================================================================-->
        <h3>
<a name="pcorr" id="pcorr"></a>プログラム修正
        </h3>
﻿<ul>
<li>
  <p>
<code>DATA</code>、<code>CODE16</code>など間違ったモード記述を持つアセンブラファイルによって、リンカでインターナルエラーが発生しなくなりました。<br>[EW22464]
  </p>
</li>

<li>
  <p>
ブロックを1つ持ち、自身のサイズよりも大きいアラインメントを持つ<code>place at end</code>リンカディレクティブで、インターナルエラーが発生しなくなりました。<br>[EW22620]
  </p>
</li>
</ul>
        <!--======================================================================-->
        <!-- USER GUIDE CORRECTIONS                                               -->
        <!--======================================================================-->
        <h3>
<a name="manuals" id="manuals"></a>ユーザガイドの訂正
        </h3>
﻿<ul>
<li>なし。</li>
</ul>
        <!--======================================================================-->
        <!-- MISCELLANEOUS                                                        -->
        <!--======================================================================-->
        <h3>
<a name="misc" id="misc"></a>その他
        </h3>
﻿<ul>
  <li>
    <p>
<b>Cortex-R4用の特別なランタイムライブラリ</b><br> Cortex-R4のためにビルドする場合、アーキテクチャ5E用のライブラリが自動的にリンカによって選択されます。ただし、ハードウェア除算を利用するには、7Rに特別なライブラリが1つ必要です。このライブラリの名前はdiv7R_t<l|b>.aで、リトルエンディアンとビッグエンディアンに1つずつあります。
    </p>
  </li>
</ul>
        <!--======================================================================-->
        <!-- RELEASE HISTORY                                                      -->
        <!--======================================================================-->
        <h3>
<a name="history" id="history"></a>リリース履歴
        </h3>
﻿<h4>V6.21 2011-07-05</h4>
<b>プログラム修正</b>
 
<ul>
	<li>なし。</li>
</ul> 
 
<b>新機能</b>
 
<ul>
<li>なし。</li>
</ul> 
 
<h4>V6.20 2011-04-29</h4>
<b>プログラム修正</b>
  <ul>
<li>
  <p>
<code>place at end of</code>ディレクティブを高いアラインメントのセクションまたはブロックを含む内容に使用しても、インターナルエラーが発生しなくなりました。<br>[EW22255]
  </p>
</li>

<li>
  <p>
<code>--strip</code>とともに<code>ielftool</code>を使用しても、文字列テーブルなどELFセクションに関するすべてのバグ情報が削除されませんでした。これらも削除されるようになりました。<br>[EW22372]
  </p>
</li>
  </ul>

<b>新機能</b>
  <ul>
  <li>
なし。
  </li>
  </ul>


<h4>V6.10 2010-11-04</h4>
<b>プログラム修正</b>
  <ul>

<li>
  <p>
リンカがエラーLp017 (compressed initializers needed an address that could not be determined until the size of compressed initializers is known - 圧縮されたイニシャライザに、圧縮されたイニシャライザが認識されるまで確定できないアドレスが必要)を出力した後で、インターナルエラーによりクラッシュすることがありました。<br>[EW21191]
  </p>
</li>

<li>
  <p>
<code>place at</code>ディレクティブに必要な内容がなく、メモリ範囲が部分的に他のセクション配置ディレクティブと重なっている場合に、インターナルエラーが発生することがありました。<br>[EW21572]
  </p>
</li>

<li>
  <p>
<code>place at</code>ディレクティブのセクション/ブロックが指定範囲に入りきらないときに、出力される診断メッセージが意味不明でした。例：<br><code>Error[Lp011]:section placement failed:unable to allocate space for sections/blocks with a total estimated minimum size of 0x0 bytes in<> (total uncommitted space 0xffffffffffff372c).Needed:</code><br>[EW21849]
  </p>
</li>

<li>
  <p>
ROMサイズの制限を持つ製品からリリースビルドの出力をロードするときに、一部のROM使用が上限に対して計算されない場合でも、C-SPYが誤ったエラー&quot;ROM size limit exceeded&quot;(ROMサイズ上限を超過)を出力することがありました。<br>[EW21909]
  </p>
</li>

<li>
  <p>
<code>ielftool</code>が、フィルとチェックサム関数を実行する際、セクションデータではなくセグメントデータを使用するようになりました。<br>[EW22329]
  </p>
</li>

<li>
  <p>
silentオプションを使用する場合、Iarchiveが正しい終了ステータスを返すようになりました。<br>[EW21944]
  </p>
</li>
  </ul>

<b>新機能</b>
  <ul>
    <li>
なし。
    </li>
  </ul>


<h4>V5.50 2010-04-21 </h4>
<b>プログラム修正</b>
  <ul>
    <li>
      <p>
必要なモジュールローカル絶対シンボルがリンカによって保持されず、スペースが予約されませんでした。<br>例：<br><code>static __no_init int array[10] @ 0x100;</code><br> [EW21528]
      </p>
    </li>

    <li>
      <p>
いくつかの<code>place at</code>コマンドが、ベニアが必要なときに重複が発生する形で使用されると、セクション配置が失敗することがありました。<br>[EW21647]
      </p>
    </li>

    <li>
      <p>
偶数の4バイト境界上で終わらないELFセクションを拡張すると、エラーとなる場合がありました。<br>[EW21654]
      </p>
    </li>

    <li>
      <p>
EWARM 5.50.5:<br><code>place at</code>セクション配置ディレクティブのシーケンスを同じメモリ領域に入れ、片方は圧縮されたイニシャライザがあって、後で内容を持たないブロックのみからなるものがある場合に、リンカでインターナルエラーが発生しなくなりました。<br>[EW21746]
      </p>
    </li>

    <li>
      <p>
EWARM 5.50.5:<br><code>ilinkarm</code> 5.50.0からは、リンカは常にinitテーブルセクションを生成するようになりました。initテーブルが必要でないビルドにおいて、これによりinitテーブルセクションに一致するセクション配置パターンを格納するための構成ファイルが無駄に必要となっていました。initテーブルセクションは、不要なときには生成されなくなりました。<br>[EW21761]
      </p>
    </li>
  </ul>

<b>新機能</b>
  <ul>
    <li>
なし。
    </li>

  </ul>

<h4>V5.41 2009-12-14 </h4>
<b>プログラム修正</b>
  <ul>
    <li>
      <p>
ベニアを必要とするコードの1ブロックをコピーすることによる初期化で、一部のコードセクションにベニアより小さいアラインメントがあった場合、リンカがエラーLp020（圧縮されたイニシャライザが大きすぎて合わない）によって失敗しなくなりました。<br>[EW21183]
      </p>
    </li>

    <li>
      <p>
EWARM 5.41.2：<br>ある範囲の<code>place in</code>ディレクティブが<code>place at</code>ディレクティブの範囲の開始/終了位置をまたいでいても、リンカがインターナルエラーによって終了しなくなりました。<br>[EW21488]
      </p>
    </li>

    <li>
      <p>
EWARM 5.41.2：<br>アセンブリコードにおいて、絶対アドレスを参照する<code>pc</code>に相対する命令(分岐のような)によって、リンクの際に誤って未定義のシンボルエラーが発生しなくなりました。<br>[EW21525]
      </p>
    </li>
  </ul>

<b>新機能</b>
  <ul>
    <li>
なし。
    </li>
  </ul>

<h4>V5.40 2009-07-10 </h4>
<b>プログラム修正</b>
  <ul>

<li>
  <p>
<code>place at</code>コマンドで必要な範囲が、より大きな開始アドレスで<code>place in</code>コマンドと一部重複したときに、セクションの配置が<code>[range allocation inconsistency]</code>というインターナルエラーにより失敗する場合がありました。<br>[EW20817]
  </p>
</li>

<li>
  <p>
圧縮されたイニシャライザを圧縮アルゴリズムのパックビット、lzwまたはbwtとともに使用する場合、イニシャライザのサイズに依存するアドレスにイニシャライザの目的地を配置できません。これを行うと、インターナルエラーが発生していましたが、新しいエラー<code>Lp021</code>が出力されるようになりました。<br>[EW20842]
  </p>
</li>

<li>
  <p>
<code>locale.h</code>ファイルをインクルードすると、フルのDLIB (ロケールサポートを含む)とのリンクが強制されていました。これは、ロケールサポートが実際に要求されたときにだけ発生するように修正されました。<br>[EW20850]
  </p>
</li>

<li>
  <p>
シンボルテーブルを入力として持たないELFファイルを使用している場合に、<code>ielftool</code>がクラッシュしなくなりました。<br>[EW20883]
  </p>
</li>

<li>
  <p>
場合によって、<code>place at</code>ディレクティブによるリンクが失敗し、エラー<code>Lp011 (section placement failed)</code>が出力されることがありました。<br>[EW20901]
  </p>
</li>

<li>
  <p>
ブロック外に複数のゼロまたはコピー領域を持つリンクジョブで初期化テーブルをビルドする際に、リンカでの内部計算エラーによって、セクション配置が失敗し、エラー<code>Lp011</code>が出力される場合がありました。<br>[EW20968, 20986]
  </p>
</li>

<li>
  <p>
コンパイラが、定数のいずれかが使用されていれば、型自体が使用されていなくても列挙型のデバッグ情報を出力します。未指定の列挙型の場合、これらの定数はデバッガで表示されませんでした。これらが表示されるようになりました。<br>[EW21053]
  </p>
</li>

<li>
  <p>
'at end'配置を使用してリンカにより生成されたinitテーブルを配置すると、リンカでインターナルエラーが発生する場合がありました。<br>[EW21065]
  </p>
</li>

<li>
  <p>
EWARM 5.40.4：<br>リンカが変更されて、自動的に選択されたライブラリはコマンドラインオプションに一致すると想定するようなりました。<br>[EW21201]
  </p>
</li>
<li>
  <p>
EWARM 5.40.4：<br>入力ELFファイルに複数のセクションを持つセグメントが含まれていると、<code>ielftool</code>が正しい出力を生成するようになりました。<br>[EW21194、EW21196、EW21286]
  </p>
</li>
  </ul>

<b>新機能</b>
  <ul>
    <li>
なし。
    </li>
  </ul>

<h4>V5.30 2009-01-23</A></h4>
<b>プログラム修正</b><p>
  <ul>
      <li>
        <p>
EWARM 5.30.2:<br> （__section_endまたは$$Limitシンボルを使用して）末端が参照されているブロック内の圧縮されたイニシャライザを使用してアプリケーションをリンクする場合、Ilinkで配列境界違反が発生し、インターナルエラーまたはより重大なエラーとなる可能性がありました。<br>[EW20796]
        </p>
      </li>

      <li>
        <p>
ゼロサイズのフラグメントのみからなる1つのセクションを持つオブジェクトファイルをリンクすると、リンカでインターナルエラーが発生しました。<br>[EW19873]
        </p>
      </li>

      <li>
        <p>
配置が空であるが、アラインメント用件を持つファイルをリンクする場合、インターナルエラー(<code>ApplyState - No allocation change</code>)によってリンカが終了することがありました。<br>[EW20353]
        </p>
      </li>

      <li>
        <p>
非常に小さいセクションの場合に、セクションの配置が失敗することがありました。通常は、関数と変数が同じメモリ領域に配置され、リーチの限界に近い呼び出しが多くあった場合にこの問題が発生する可能性がありました。これによって、いくつのベニアが必要なのかが非常に不明確になっていました。<br>[EW20464]
        </p>
      </li>

      <li>
        <p>
適切なエラーメッセージが出力された後、プログラム内の一部のセクションがいずれかの配置ディレクティブと一致しなければ、インターナルエラーが発生してリンカが終了する場合がありました。<br>[EW20481]
        </p>
      </li>

      <li>
        <p>
同じ開始アドレス上にある<code>place in</code>ディレクティブおよび<code>place at</code>ディレクティブが設定に含まれ、<code>place at</code>ディレクティブがゼロバイトを占有する場合、リンカがインターナルエラーで終了する可能性がありました。<br>[EW20656]
        </p>
      </li>

      <li>
        <p>
--interworkなしにコンパイルされ、静的関数とパブリック関数が混在する変換ユニット内の関数に対する互換性チェックは、これまでリンカで壊れていました。このために、誤った互換エラー(Lt020)が発生するだけでなく、報告すべきでありながらこうした問題を報告できないという結果になっていました。<br>[EW20745]
        </p>
      </li>
  </ul>
<b>新機能</b><p>
  <ul>
  <li>
<p><b>イニシャライザの圧縮</b><br> リンカは初期化したデータを圧縮して、フラッシュの使用を最小に抑えることができます。圧縮されたデータは、フラッシュからRAMに移動すると起動コードによって自動的に解凍されます。
    </p>
  </li>
  </ul>

<h4>V5.20 2008-06-24</A></h4>
<b>プログラム修正</b><p>
  <ul>
      <li>
        <p>
<code> export </code>ディレクティブを使用してリンカ設定ファイルから不明なシンボルをエクスポートしても、問題を報告した後で<code> ilinkarm </code>がインターナルエラーにより終了しなくなりました。<br>[EW19729]
        </p>
      </li>
      <li>
        <p>
<code>ielftool </code>は、長さが4の倍数でないELFセクションについて、sum32チェックサムを計算できるようになりました。<br>[EW19817]
        </p>
      </li>
      <li>
        <p>
<code>ielftool </code>は、長さが4の倍数でないELFファイルについて、フィル処理を実行できるようになりました。<br>[EW19835]
        </p>
      </li>
      <li>
        <p>
<code>ilinkarm </code>が、ゼロ化されたinitテーブルのエントリを出力可能になりました。以前は、プログラム起動時に、ゼロでフィルされるべき1つまたは複数のメモリ範囲が、ゼロでフィルされなくなっていました。<br>[EW19853]
        </p>
      </li>
      <li>
        <p>
MISRA-C規則23をチェックする際に、<code> ilinkarm </code>がツールの内部シンボルを誤って含むことがなくなり、不要な規則違反エラーとなることがなくなりました。また、エラーLi0005 (未定義のシンボル)が以前に発生した場合に、<br> <code>ilinkarm </code>がクラッシュしなくなりました。<br>[EW19897]
        </p>
      </li>
      <li>
        <p>
どのセクションにも一致せず、<code> place in </code>ディレクティブのメモリ範囲と重複し、ブロックを含まない<code> place at </code>ディレクティブによって、リンク時にインターナルエラーとなることがなくなりました。<br>[EW19952]<br> [EW20030]
        </p>
      </li>
      <li>
        <p>
重複する範囲を含むプロジェクトをリンクする際に、重複のサイズが範囲と比較して小さい場合、<code> ilinkarm </code>がインターナルエラーで終了しなくなりました。<br>[EW19985]
        </p>
      </li>
      <li>
        <p>
ソースELFファイルで新しいベースアドレスで始まるセクションの前にデータが含まれない場合、<code> ielftool </code>からのIntel hex出力に不正なベースアドレスレコードが含まれなくなりました。<br>[EW20031]
        </p>
      </li>
      <li>
        <p>
ブロック内のコードのコピー初期化で、ブロックの最初がベニアの場合に、生成が正しく行われるようになりました。<br>[EW20040]
        </p>
      </li>
      <li>
        <p>
リンカ設定ファイルでチェーンになっている<code> if </code>ディレクティブ(<code>if...else if...else</code>)が、正しく機能するようになりました。<br>[EW20104]
        </p>
      </li>
      <li>
        <p>
<code> place at </code>および<code> place in </code>セクション配置ディレクティブが同じ開始アドレスを使用する場合、リンカでインターナルエラー（範囲割当ての不一致）が発生しなくなりました。<br>[EW20183]
        </p>
      </li>
  </ul>
<b>新機能</b><p>
  <ul>
  <li>
<p><b>RAMへのコードのコピー</b><br> プログラム起動時にコードのすべてをRAMにコピーする機能が改善されました。上記を参照してください。
    </p>
  </li>
  <li>
<p><b>位置に依存しないベニア</b><br> リンカが、<code>--pi_veneers</code>コマンドラインオプションを使用して、位置に依存しないベニアを生成できます。
    </p>
  </li>
  </ul>

<h4>V5.11 2007-12-11</A></h4>
  <ul>
  <li><p>
<code>ilinkarm </code>が、誤って<code> place at </code>リンカディレクティブの始めにフォールスルーベニアを配置し、そこで終わるべきセクションを間違った位置に置いていました。<br>[EW19456]
  </p></li>

  <li><p>
<code>ielftool </code>(以前の<code> ichecksum</code>)が、ビッグエンディアンファイルのチェックサムを正しく処理するようになりました。<br>[EW19466]
  </p></li>

  <li><p>
<code>ielftool </code>(以前の<code> ichecksum</code>) が算術合計アルゴリズムを認識しませんでした。<br>[EW19490]
  </p></li>

  <li><p>
場合によっては、<code> ielftool </code>(以前の<code> ichecksum</code>) がチェックサムの値を出力ファイルに書き込みませんでした。<br>[EW19496]
  </p></li>

  <li><p>
リンカが、入力に同じシンボルの弱い定義が混在する場合、同じシンボルに対して複数の定義を誤ってインクルードしたため、一部の定義がELFセクショングループを使用し、他の定義でそれが使用されていないという状態になっていました。<br> [EW19502]
  </p></li>

  <li><p>
<code>ielftool </code>(以前の<code> ichecksum</code>) が、チェックサムのプレースホルダ変数が<code> const</code>として定義されていない場合に、エラーメッセージを出力するようになりました。<br>[EW19538]
  </p></li>

  <li><p>
<code> place in </code>範囲の真ん中で<code> place at </code>を使用すると、インターナルエラーが発生する場合がありました。<br>[EW19578]
  </p></li>

  <li>
    <p>
<code>ilinkarm </code>が時おり、'place at'配置で必要のない余分なバイトを予約していました。<br>[EW19604]
    </p>
  </li>

  <li>
    <p>
場合によっては、フォールスルーのモードを変更するベニアを、ベニアの目的地の直前以外の場所に配置することができ、コードが機能しなくなっていました。<br>[EW19726]
    </p>
  </li>
  </ul>

<h4>V5.10 2007-05-25</A></h4>
  <ul>
    <li>
初回リリース。
    </li>
  </ul>
</ul>
    </div>
</body>
</html>
